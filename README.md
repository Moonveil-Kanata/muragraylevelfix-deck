# An Ultimate Way to Fix Gray-Level and Mura on Steam Deck

### TL;DR

Average Samsung-panel on Steam Deck have known-issues called Mura Effect, where it has bad gray-uniformity. Resulting, grainy/dirty looks on the screen which can consider looks like a noise or film grain. Causing gradient effects on near-black looks like banding when fading into black.

After certain level of brightness between 35/40% above and certain higher screen hertz, it seems grey level is raised too much. Resulting raised black, more visible mura, and bad transition effects on gradient between black-level and grey is more prominent.

In a nutshell, **you can fix it by set your screen hertz between 47hz-66hz and set your brightness between 35/40%, and disable mura compensation on developer settings**. And you will get the screen where it should be, perfect black and nice gradient on near-black. **But this is not apply with higher brightness.**

## How is this fix works?

Correction on OLED screen is a common thing, if you've OLED TV it's a common thing if you can give dithering correction, smooth gradient correction etc.

The idea is, reduce lift & gamma a bit at the grey-level to black-level pixel only. And give some film grain on that pixel to dither the gradient, to prevent mura visibility on the grey to dark by a lot. While the mura fix is using your mura map generated by your device and apply it only on gray to bright level pixel, so the black pixel will have perfect black.

### Pros
- Perfect black (Mura map fix only on bright and near-black pixel)
- Dithering using film grain on near-black pixel
- Great gradient on high brightness
- Work with 16:10 and 16:9

### Cons
Cons is very perspective by your eyes, you can adjust every setting later anyway
- On low brightness below 35, shadow detail is a bit loss
- If you've sensitive eye, you can see film grain moving on the near-black gradient
- Not working on UI, only work in-game with Vulkan/dX. While OpenGL isn't working
- When plugged into monitor the effect still on, but you cannot really see the mura map tho. You can always toggle to off
- Gradient still looks weird in some games/HDR

# Usage
Reshadeck can do this also. But I find even using an empty fx, reshadeck tank the performance so bad, you can use it only for a testing purpose. While vkbasalt almost no visible performance hit.

Installation
1. Install vkbasalt locally, follow this guide https://github.com/simons-public/steam-deck-vkbasalt-install
2. Download my custom fix shader and extract
3. Set your screen to 60hz for cleaner image (Or test by yourself every hz, which hertz that has less mura effect)
4. Go to developer settings, disable mura compensation for a perfect black. As the shader already have this fix
5. Done, the shader work globally to all of you vulkan/dx games. You can toggle the effect by open your keyboard by pressing 'steam+x' and 'tab' button

## Troubleshoot
### Emu Deck
For Emu Deck after a couple test logging, it seems .appimage apps keep reading the x86 lib while they're running on x64. This method will make all emudeck emulators work with vkbasalt.

1. Find "/home/deck/.local/share/vulkan/implicit_layer.d/"
2. rename file "vkBasalt.x86.json" to "vkBasalt.x86.json.bak"
3. Enjoy :)

### HDR Games
HDR game have pale base rgb and higher mura-effect. So use this launch-command per-game with active HDR compatible games.
```
VKBASALT_CONFIG_FILE=/home/deck/.config/vkBasalt/vkBasalt_HDR.conf %command%
```

### Auto HDR Games
For some of you using auto hdr reshade(non vkbasalt) from here https://www.reddit.com/r/SteamDeck/comments/1b4rbd8/auto_hdr_works_on_steam_deck_now/

you can apply this command per-game
```
VKBASALT_CONFIG_FILE=/home/deck/.config/vkBasalt/vkBasalt_AutoHDR.conf %command%
```

## What will be in the Future?
I hope this kind of fix is applied from the system-level by Steam developer itself. Especially with the current mura compensation where the mura map still visible on the black pixel.

You see, that we need a couple fx to fix the certain scenario. If only this is applied to the system-level, where the steam developer have an access to the current brightness percentage, so it can do correction according to the current brightness level.

These problems not seen by 1 or 2, but by a lot of buyers. I see a lot of refund caused by this problem, there is no way steam won't fix this except they will keep receiving a refund.

While I don't have any time to do refund, RMA or anything that there is no guarantee of getting the perfect panel, I just want to enjoy it. Also LE version, isn't available on every countries. I love the deck because I'm tired with windows and love what valve do with linux gaming community. So, decided to keep this device and find the solution instead.

## Credit
Thanks to these amazing guys, these are my references to make this works.
- Film Grain Reference - Christian Cann Schuldt Jensen ~ CeeJay.dk
- Lift Gamma Gain Reference - 3an and CeeJay.dk
- Original mura fix reference - https://www.reddit.com/r/SteamDeck/comments/1aej469/maybe_we_can_correct_mura_like_this_for_now/
- Mura fix v2 reference - https://www.reddit.com/r/SteamDeck/comments/1au9blh/updated_fix_for_steamdeck_oled_mura_noise_in/
- vkBasalt local on Deck https://github.com/simons-public/steam-deck-vkbasalt-install
